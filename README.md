采用基于 XGBoost 的集成学习方法，针对 SSH 隧道下 HTTP、FTP、SCP 等三种常用应用进行分类识别。

1.收集实验数据集。本文搭建了两台 Linux 虚拟机，版本为 Ubuntu 64 位，作为客户机和服务器。
使用 Xshell 7 作为 SSH 客户端，使用 Xshell 来在本机与虚拟机之间传输数据，编写脚本文件在客户端运行，
通过抓包工具 Wireshark 抓取产生的通信流量，得到的 PCAP 文件作为实验中所使用到的流量包数据集。这
里分了五组，每组采用的传输文件和网址都不一样，每组抓获包含 SSH 隧道下
FTP、HTTP、SCP 三种流量包集各 5000 个，总共 15000 个数据集。

2.特征向量的选择。选定了 1 个标识字符串，30 个包长大小和网络流级别的 27 个统计信息共计 58 个特征以供实验使用。其中标识字符串是
用来判断是否为 SSH 加密流量的，训练和测试时使用的是后 57 个特征向量。而
在实际实验过程中，发现了 7 个无效的特征向量，去除后，通过变量重要性指标
对剩余的 50 个特征向量做一个排序，发现基于网络流的特征向量起主要作用。

3.基于 XGBoost 集成学习方法的参数优化。为了防止过拟合，提高泛化能力，
所以本文着重 max_depth 和 min_child_weight 这两个参数进行优化。本文设置的
max_depth 的范围为 4 到 7、min_child_weight 的范围为 3 到 7，采用的方法是进
行 5 轮，每轮随机选取数据集的子集，比例为 0.2，即每轮 3000 个，测试集与训
练集的比例为 4：1，将得出的 accuracy 平均值和方差进行比较，最终选取最合
适的参数组合。

4.八种机器学习方法对比分析。本文采用了 XGBoost、多层感知机、多项式
贝叶斯、高斯贝叶斯、支持向量机、K-近邻分类器、决策树和随机森林这八种不
同的机器学习算法在相同的数据集上进行训练和测试，通过对不同应用的识别精
准率、召回率和整体准确率这三个评价标准进行综合比较分析后发现基于
XGBoost 集成学习方法的表现最为良好。

数据与程序见压缩包，使用方法见教程。
